{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('web3-utils'), require('ethers/utils/abi-coder'), require('@babel/runtime/helpers/typeof'), require('@babel/runtime/helpers/classCallCheck'), require('@babel/runtime/helpers/createClass'), require('lodash/isArray'), require('lodash/isObject')) : typeof define === 'function' && define.amd ? define(['exports', 'web3-utils', 'ethers/utils/abi-coder', '@babel/runtime/helpers/typeof', '@babel/runtime/helpers/classCallCheck', '@babel/runtime/helpers/createClass', 'lodash/isArray', 'lodash/isObject'], factory) : factory(global.Web3EthAbi = {}, global.Utils, global.abiCoder, global._typeof, global._classCallCheck, global._createClass, global.isArray, global.isObject);\n})(this, function (exports, Utils, abiCoder, _typeof, _classCallCheck, _createClass, isArray, isObject) {\n  'use strict';\n\n  _typeof = _typeof && _typeof.hasOwnProperty('default') ? _typeof['default'] : _typeof;\n  _classCallCheck = _classCallCheck && _classCallCheck.hasOwnProperty('default') ? _classCallCheck['default'] : _classCallCheck;\n  _createClass = _createClass && _createClass.hasOwnProperty('default') ? _createClass['default'] : _createClass;\n  isArray = isArray && isArray.hasOwnProperty('default') ? isArray['default'] : isArray;\n  isObject = isObject && isObject.hasOwnProperty('default') ? isObject['default'] : isObject;\n\n  var AbiCoder = function () {\n    function AbiCoder(utils, ethersAbiCoder) {\n      _classCallCheck(this, AbiCoder);\n\n      this.utils = utils;\n      this.ethersAbiCoder = ethersAbiCoder;\n    }\n\n    _createClass(AbiCoder, [{\n      key: \"encodeFunctionSignature\",\n      value: function encodeFunctionSignature(functionName) {\n        if (isObject(functionName)) {\n          functionName = this.utils.jsonInterfaceMethodToString(functionName);\n        }\n\n        return this.utils.sha3(functionName).slice(0, 10);\n      }\n    }, {\n      key: \"encodeEventSignature\",\n      value: function encodeEventSignature(functionName) {\n        if (isObject(functionName)) {\n          functionName = this.utils.jsonInterfaceMethodToString(functionName);\n        }\n\n        return this.utils.sha3(functionName);\n      }\n    }, {\n      key: \"encodeParameter\",\n      value: function encodeParameter(type, param) {\n        return this.encodeParameters([type], [param]);\n      }\n    }, {\n      key: \"encodeParameters\",\n      value: function encodeParameters(types, params) {\n        return this.ethersAbiCoder.encode(this._mapTypes(types), params);\n      }\n    }, {\n      key: \"_mapTypes\",\n      value: function _mapTypes(types) {\n        var _this = this;\n\n        var mappedTypes = [];\n        types.forEach(function (type) {\n          if (_this._isSimplifiedStructFormat(type)) {\n            var structName = Object.keys(type)[0];\n            mappedTypes.push(Object.assign(_this._mapStructNameAndType(structName), {\n              components: _this._mapStructToCoderFormat(type[structName])\n            }));\n            return;\n          }\n\n          mappedTypes.push(type);\n        });\n        return mappedTypes;\n      }\n    }, {\n      key: \"_isSimplifiedStructFormat\",\n      value: function _isSimplifiedStructFormat(type) {\n        return _typeof(type) === 'object' && typeof type.components === 'undefined' && typeof type.name === 'undefined';\n      }\n    }, {\n      key: \"_mapStructNameAndType\",\n      value: function _mapStructNameAndType(structName) {\n        var type = 'tuple';\n\n        if (structName.indexOf('[]') > -1) {\n          type = 'tuple[]';\n          structName = structName.slice(0, -2);\n        }\n\n        return {\n          type: type,\n          name: structName\n        };\n      }\n    }, {\n      key: \"_mapStructToCoderFormat\",\n      value: function _mapStructToCoderFormat(struct) {\n        var _this2 = this;\n\n        var components = [];\n        Object.keys(struct).forEach(function (key) {\n          if (_typeof(struct[key]) === 'object') {\n            components.push(Object.assign(_this2._mapStructNameAndType(key), {\n              components: _this2._mapStructToCoderFormat(struct[key])\n            }));\n            return;\n          }\n\n          components.push({\n            name: key,\n            type: struct[key]\n          });\n        });\n        return components;\n      }\n    }, {\n      key: \"encodeFunctionCall\",\n      value: function encodeFunctionCall(jsonInterface, params) {\n        return this.encodeFunctionSignature(jsonInterface) + this.encodeParameters(jsonInterface.inputs, params).replace('0x', '');\n      }\n    }, {\n      key: \"decodeParameter\",\n      value: function decodeParameter(type, bytes) {\n        return this.decodeParameters([type], bytes)[0];\n      }\n    }, {\n      key: \"decodeParameters\",\n      value: function decodeParameters(outputs, bytes) {\n        if (outputs.length > 0 && (!bytes || bytes === '0x' || bytes === '0X')) {\n          throw new Error(\"Returned values aren't valid, did it run Out of Gas?\");\n        }\n\n        var res = this.ethersAbiCoder.decode(this._mapTypes(outputs), \"0x\".concat(bytes.replace(/0x/i, '')));\n        var returnValues = {};\n        var decodedValue;\n        outputs.forEach(function (output, i) {\n          decodedValue = res[i];\n          decodedValue = decodedValue === '0x' ? null : decodedValue;\n          returnValues[i] = decodedValue;\n\n          if (isObject(output) && output.name) {\n            returnValues[output.name] = decodedValue;\n          }\n        });\n        return returnValues;\n      }\n    }, {\n      key: \"decodeLog\",\n      value: function decodeLog(inputs) {\n        var _this3 = this;\n\n        var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n        var topics = arguments.length > 2 ? arguments[2] : undefined;\n        var topicCount = 0;\n\n        if (!isArray(topics)) {\n          topics = [topics];\n        }\n\n        var notIndexedInputs = [];\n        var indexedParams = [];\n        inputs.forEach(function (input, i) {\n          if (input.indexed) {\n            indexedParams[i] = ['bool', 'int', 'uint', 'address', 'fixed', 'ufixed'].find(function (staticType) {\n              return input.type.indexOf(staticType) !== -1;\n            }) ? _this3.decodeParameter(input.type, topics[topicCount]) : topics[topicCount];\n            topicCount++;\n          } else {\n            notIndexedInputs[i] = input;\n          }\n        });\n        var nonIndexedData = data;\n        var notIndexedParams = nonIndexedData ? this.decodeParameters(notIndexedInputs, nonIndexedData) : [];\n        var returnValues = {};\n        inputs.forEach(function (res, i) {\n          returnValues[i] = res.type === 'string' ? '' : null;\n\n          if (typeof notIndexedParams[i] !== 'undefined') {\n            returnValues[i] = notIndexedParams[i];\n          }\n\n          if (typeof indexedParams[i] !== 'undefined') {\n            returnValues[i] = indexedParams[i];\n          }\n\n          if (res.name) {\n            returnValues[res.name] = returnValues[i];\n          }\n        });\n        return returnValues;\n      }\n    }]);\n\n    return AbiCoder;\n  }();\n\n  var AbiModuleFactory = function () {\n    function AbiModuleFactory() {\n      _classCallCheck(this, AbiModuleFactory);\n    }\n\n    _createClass(AbiModuleFactory, [{\n      key: \"createAbiCoder\",\n      value: function createAbiCoder(utils) {\n        return new AbiCoder(utils, new abiCoder.AbiCoder(function (type, value) {\n          if (type.match(/^u?int/) && !isArray(value) && (!isObject(value) || value.constructor.name !== 'BN')) {\n            return value.toString();\n          }\n\n          return value;\n        }));\n      }\n    }]);\n\n    return AbiModuleFactory;\n  }();\n\n  var AbiCoder$1 = function AbiCoder() {\n    return new AbiModuleFactory().createAbiCoder(Utils);\n  };\n\n  exports.AbiCoder = AbiCoder$1;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","map":null,"metadata":{},"sourceType":"script"}